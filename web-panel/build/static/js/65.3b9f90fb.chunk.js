(window["webpackJsonpgogo-react"]=window["webpackJsonpgogo-react"]||[]).push([[65],{1099:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),s=a(269),c=a(27),o=a(256),i=a(257),l=a(259),u=a(258),d=a(263),m=a(260),p=a(1),g=a.n(p),b=a(264),_=a(284),f=a(285),h=a(276),v=a(1047),y=a(1048),E=a(353),O=a(268),x=a(267),C=a(254),S=a(265),j=a(261),k=a(255),N=a(39),w=a(40),D=a(293),P=["image/jpg","image/jpeg","image/gif","image/png"],T=x.object().shape({business_category:x.string().required("Please select a business category"),product_category:x.string().required("Please select a product category"),product_subcategory:x.string().required("Please select a sub category"),product_inv_id:x.string().required("Please select a product inventory"),title:x.string().required("Please enter deal of the day title").min(2,"Too Short! Atleast 2 letters.").max(50,"Too Long! Atmost 50 letters."),description:x.string().required("Please enter deal of the day description").min(2,"Too Short! Atleast 2 letters.").max(200,"Too Long! Atmost 200 letters."),image:x.mixed().test("fileType","Invalid File Format",function(e){return!e||""==e||e&&P.includes(e.type)})}),A=[],L=[],B=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getBusinessCategories=Object(c.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.state.isLoading=!0,t=w.a.GET_BUSSINESS_CATEGORIES+"?page_no=1&limit=100",e.next=4,Object(N.a)("GET",t);case 4:200==(n=e.sent).status?a.setState({businessCatList:[].concat(Object(s.a)(a.state.businessCatList),Object(s.a)(n.data.docs))}):S.a.error(n.message,"Error!",3e3);case 6:case"end":return e.stop()}},e)})),a.getPerentCategories=function(){var e=Object(c.a)(r.a.mark(function e(t){var n,c,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),(n=new FormData).append("business_category_id",t),c=w.a.GET_CATEGORIES_BY_BUSINESS,e.next=6,Object(N.a)("POST",c,n);case 6:200==(o=e.sent).status?(i=[{_id:"",name:"Select"}],a.setState({parentCatList:[].concat(i,Object(s.a)(o.data.docs))})):S.a.error(o.message,"Error!",3e3);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.getSubCategories=function(){var e=Object(c.a)(r.a.mark(function e(t,n){var c,o,i,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.state.isLoading=!0,c=[{_id:"",name:"Select"}],!n){e.next=13;break}return(o=new FormData).append("business_category_id",t),o.append("category_id",n),i=w.a.GET_SUBCATEGORIES,e.next=9,Object(N.a)("POST",i,o);case 9:200==(l=e.sent).status?a.setState({subCatList:[].concat(c,Object(s.a)(l.data.docs))}):S.a.error(l.message,"Error!",3e3),e.next=14;break;case 13:a.setState({subCatList:c});case 14:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.getProducts=function(){var e=Object(c.a)(r.a.mark(function e(t,n,c,o){var i,l,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t,n,c),a.state.isLoading=!0,i=[{id:"",name:"Select"}],A=[],L=[],!c){e.next=17;break}return(l=new FormData).append("business_category_id",t),l.append("category_id",n),l.append("sub_category_id",c),u=w.a.GET_DEALOFDAY_PRODUCTS,e.next=13,Object(N.a)("POST",u,l);case 13:200==(d=e.sent).status?(a.setState({productList:[].concat(i,Object(s.a)(d.data))}),d.data.map(function(e,t){A.push({key:t,value:e.id,label:e.inventory_name}),Array.isArray(a.state.product_inv_id)&&-1!==a.state.product_inv_id.indexOf(e.id)&&L.push({key:t,value:e.id,label:e.inventory_name})}),0==L.length?(A=[],a.setState({options:A}),o("options",A)):a.setState({product_inv_id:L})):S.a.error(d.message,"Error!",3e3),e.next=18;break;case 17:a.setState({productList:i});case 18:case"end":return e.stop()}},e)}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.dataRender=Object(c.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=w.a.GET_DEALOFDAY+"/"+a.state.itemId,e.next=3,Object(N.a)("GET",t);case 3:200==(n=e.sent).status?(a.setState({title:n.data.title,description:n.data.description,business_category:n.data.business_category._id,product_category:n.data.category._id,product_subcategory:n.data.subcategory._id,product_inv_id:(n.data.product_id,n.data.product_id),image_preview:n.data.image_thumb_url,statusactiveDate:n.data.statusactiveDate,isLoading:!0}),a.getBusinessCategories(),a.getPerentCategories(n.data.business_category._id),a.getSubCategories(n.data.business_category._id,n.data.category._id),a.getProducts(n.data.business_category._id,n.data.category._id,n.data.subcategory._id)):S.a.error(n.message,"Error!",3e3);case 5:case"end":return e.stop()}},e)})),a.handleSubmit=function(){var e=Object(c.a)(r.a.mark(function e(t){var n,s,c,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Array,Array.isArray(t.product_inv_id)?t.product_inv_id.map(function(e,t){n.push(e.value)}):n.push(t.product_inv_id.value),(s=new FormData).append("business_category_id",t.business_category),s.append("category_id",t.product_category),s.append("sub_category_id",t.product_subcategory),s.append("product_id","undefined"!==typeof t.product_inv_id?JSON.stringify(n):null),s.append("title",t.title),s.append("description",t.description),s.append("image",t.image),c=w.a.UPDATE_DEALOFDAY+"/"+a.state.itemId,e.next=13,Object(N.a)("PUT",c,s);case 13:200==(o=e.sent).status?(S.a.success(o.message,"Success!",3e3),a.props.history.push({pathname:"/app/dealofday",state:{pageIndex:a.state.currentPage}})):S.a.error(o.message,"Error!",3e3);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.calculetetime=function(e){var t=new Date-new Date(e),a=Math.floor(t/864e5),n=Math.floor(t%864e5/36e5),r=Math.round(t%864e5%36e5/6e4);return a<1?n+" hours, "+r+" minutes ":"Expired"},a.state={itemId:e.match.params.itemId,business_category:"",product_category:"",product_subcategory:"",product_inv_id:[],title:"",description:"",statusactiveDate:"",image:void 0,currentPage:a.props.history.location.state.pageIndex,businessCatList:[{_id:"",name:"Select"}],parentCatList:[{_id:"",name:"Select"}],subCatList:[{_id:"",name:"Select"}],productList:[{id:"",name:"Select"}]},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.dataRender()}},{key:"render",value:function(){var e=this;this.props.intl.messages;return g.a.createElement(p.Fragment,null,g.a.createElement(_.a,null,g.a.createElement(C.a,{xxs:"12"},g.a.createElement(j.a,{heading:"heading.edit-dealofday",match:this.props.match}),g.a.createElement(C.b,{className:"mb-5"}))),g.a.createElement(_.a,null,g.a.createElement(C.a,{xxs:"12",sm:"12"},g.a.createElement(f.a,null,g.a.createElement(h.a,null,g.a.createElement(O.c,{enableReinitialize:!0,initialValues:{business_category:this.state.business_category,product_category:this.state.product_category,product_subcategory:this.state.product_subcategory,product_inv_id:this.state.product_inv_id,title:this.state.title,description:this.state.description,image:this.state.image},validationSchema:T,onSubmit:this.handleSubmit},function(t){t.handleSubmit;var a=t.setFieldValue,n=t.setFieldTouched,r=(t.handleChange,t.values),s=t.errors,c=t.touched;t.isSubmitting;return g.a.createElement(O.b,{className:"av-tooltip tooltip-label-bottom"},g.a.createElement(_.a,null,g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Business Category"),g.a.createElement("select",{name:"business_category",className:"form-control",value:r.business_category,onChange:function(t){a("business_category",t.target.value),a("product_category",""),a("product_subcategory",""),a("product_inv_id",""),e.getPerentCategories(t.target.value)}},e.state.businessCatList.map(function(e,t){return g.a.createElement("option",{key:t,value:e._id},e.name)})),s.business_category&&c.business_category?g.a.createElement("div",{className:"invalid-feedback d-block"},s.business_category):null)),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Product Category"),g.a.createElement("select",{name:"product_category",className:"form-control",value:r.product_category,onChange:function(t){a("product_category",t.target.value),a("product_subcategory",""),a("product_inv_id",""),e.getSubCategories(r.business_category,t.target.value)}},e.state.parentCatList.map(function(e,t){return g.a.createElement("option",{key:t,value:e._id},e.name)})),s.product_category&&c.product_category?g.a.createElement("div",{className:"invalid-feedback d-block"},s.product_category):null)),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Product Sub Category"),g.a.createElement("select",{name:"product_subcategory",className:"form-control",value:r.product_subcategory,onChange:function(t){a("product_subcategory",t.target.value),a("product_inv_id",""),console.log(r.business_category,r.product_category,t.target.value),e.getProducts(r.business_category,r.product_category,t.target.value,a)}},e.state.subCatList.map(function(e,t){return g.a.createElement("option",{key:t,value:e._id},e.name)})),s.product_subcategory&&c.product_subcategory?g.a.createElement("div",{className:"invalid-feedback d-block"},s.product_subcategory):null)),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Product Inventory"),g.a.createElement(D.c,{name:"product_inv_id",id:"product_inv_id",value:r.product_inv_id,isMulti:!0,options:A,onChange:a,onBlur:n}),s.product_inv_id&&c.product_inv_id?g.a.createElement("div",{className:"invalid-feedback d-block"},s.product_inv_id):null)),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Deal Of Day Title"),g.a.createElement(O.a,{className:"form-control",name:"title",type:"text"}),s.title&&c.title?g.a.createElement("div",{className:"invalid-feedback d-block"},s.title):null)),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Deal Of Day Description"),g.a.createElement(O.a,{className:"form-control",name:"description",component:"textarea"}),s.description&&c.description?g.a.createElement("div",{className:"invalid-feedback d-block"},s.description):null)),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Deal Of Day Image"),g.a.createElement(O.a,{className:"form-control",name:"image",type:"file",value:e.state.image,onChange:function(e){a("image",e.currentTarget.files[0])}}),s.image&&c.image?g.a.createElement("div",{className:"invalid-feedback d-block"},s.image):null),g.a.createElement("img",{alt:e.state.name,src:e.state.image_preview,className:"img-thumbnail border-0 list-thumbnail align-self-center image-preview"})),g.a.createElement(C.a,{xxs:"12",sm:"6"},g.a.createElement(v.a,{className:"form-group has-float-label"},g.a.createElement(y.a,null,"Activated time "),g.a.createElement("br",null),e.calculetetime(e.state.statusactiveDate)))),g.a.createElement(E.a,{color:"primary",type:"submit"},g.a.createElement(k.a,{id:"button.save"})))}))))))}}]),t}(p.Component);t.default=Object(b.d)(B)},254:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return o});var n=a(1),r=a.n(n),s=a(283),c=function(e){return r.a.createElement(s.a,Object.assign({},e,{widths:["xxs","xs","sm","md","lg","xl","xxl"]}))},o=function(e){return r.a.createElement("div",{className:"separator ".concat(e.className)})}},261:function(e,t,a){"use strict";var n=a(1),r=a.n(n),s=a(274),c=a(275),o=a(262),i=a(255),l=function(e){return r.a.createElement(i.a,{id:"menu.".concat(e)})},u=function(e,t,a){return 0===a?"":e.split(t)[0]+t},d=function(e){var t=e.match.path.substr(1),a=t.split("/");return a[a.length-1].indexOf(":")>-1&&(a=a.filter(function(e){return-1===e.indexOf(":")})),r.a.createElement(n.Fragment,null,r.a.createElement(s.a,{className:"pt-0 breadcrumb-container d-none d-sm-block d-lg-inline-block"},a.map(function(e,n){return r.a.createElement(c.a,{key:n,active:a.length===n+1},a.length!==n+1?r.a.createElement(o.c,{to:"/"+u(t,e,n)},l(e)):l(e))})))};t.a=function(e){var t=e.heading,a=e.match;return r.a.createElement(n.Fragment,null,t&&r.a.createElement("h1",null,r.a.createElement(i.a,{id:t})),r.a.createElement(d,{match:a}))}},278:function(e,t,a){},293:function(e,t,a){"use strict";a.d(t,"c",function(){return h}),a.d(t,"a",function(){return v}),a.d(t,"b",function(){return y});var n=a(269),r=a(256),s=a(257),c=a(259),o=a(258),i=a(260),l=a(1),u=a.n(l),d=a(306),m=a(1049),p=a(303),g=a.n(p),b=(a(304),a(270)),_=a.n(b),f=(a(278),a(299)),h=(a(298),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).handleChange=function(e){a.props.onChange(a.props.name,e)},a.handleBlur=function(){a.props.onBlur(a.props.name,!0)},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.a.createElement(d.b,{className:"react-select ".concat(this.props.className),classNamePrefix:"react-select",options:this.props.options,isMulti:this.props.isMulti,onChange:this.handleChange,onBlur:this.handleBlur,value:this.props.value})}}]),t}(u.a.Component)),v=(u.a.Component,u.a.Component,u.a.Component,function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).handleChange=function(e){a.props.onChange(a.props.name,e)},a.handleBlur=function(){a.props.onBlur(a.props.name,!0)},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.name,n=t.value,r=t.options,s=t.inline,c=void 0!==s&&s;return u.a.createElement(u.a.Fragment,null,r.map(function(t,r){return u.a.createElement(m.a,{key:"".concat(a,"_").concat(t.value,"_").concat(r),type:"radio",id:"".concat(a,"_").concat(t.value,"_").concat(r),name:t.name,label:t.label,onChange:function(){return e.handleChange(t.value)},onBlur:e.handleBlur,checked:n===t.value,disabled:t.disabled,inline:c})}))}}]),t}(u.a.Component)),y=(u.a.Component,u.a.Component,function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).handleChange=function(e){a.props.onChange(a.props.name,e)},a.handleBlur=function(e){a.props.onBlur(a.props.name,!0)},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.value,n=e.className;return u.a.createElement(f.a,{id:t,name:t,className:n,selected:a,onChange:this.handleChange,onBlur:this.handleBlur})}}]),t}(u.a.Component))}}]);
//# sourceMappingURL=65.3b9f90fb.chunk.js.map